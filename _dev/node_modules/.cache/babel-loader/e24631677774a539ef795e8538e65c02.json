{"remainingRequest":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/thread-loader/dist/cjs.js!/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/babel-loader/lib/index.js!/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/david/Workspace/PrestaShop/ps_accounts/_dev/src/components/PsAccount.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/src/components/PsAccount.vue","mtime":1581094375456},{"path":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/cache-loader/dist/cjs.js","mtime":1580829599339},{"path":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/thread-loader/dist/cjs.js","mtime":1580829599315},{"path":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/babel-loader/lib/index.js","mtime":1580829599343},{"path":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/cache-loader/dist/cjs.js","mtime":1580829599339},{"path":"/home/david/Workspace/PrestaShop/ps_accounts/_dev/node_modules/vue-loader/lib/index.js","mtime":1580829601153}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuY29uY2F0IjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuc2xpY2UiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5mdW5jdGlvbi5uYW1lIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMub2JqZWN0LmVudHJpZXMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3Qua2V5cyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnJlZ2V4cC5leGVjIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnJlcGxhY2UiOwppbXBvcnQgX3NsaWNlZFRvQXJyYXkgZnJvbSAiL2hvbWUvZGF2aWQvV29ya3NwYWNlL1ByZXN0YVNob3AvcHNfYWNjb3VudHMvX2Rldi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vc2xpY2VkVG9BcnJheSI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCgovKiBlc2xpbnQtZGlzYWJsZSBuby1jb25zb2xlICovCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnUHNBY2NvdW50JywKICBwcm9wczogewogICAgYnV0dG9uVGV4dDogU3RyaW5nLAogICAgdnVlX2FwcF9zdmNfdWlfdXJsOiBTdHJpbmcKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBzdmNfdWlfdXJsOiBudWxsLAogICAgICBwYXJhbXNfbG9hZGVkOiBmYWxzZSwKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwdWJLZXk6IG51bGwsCiAgICAgICAgbmFtZTogbnVsbCwKICAgICAgICBibzogbnVsbCwKICAgICAgICBuZXh0OiBudWxsCiAgICAgIH0KICAgIH07CiAgfSwKICBtb3VudGVkOiBmdW5jdGlvbiBtb3VudGVkKCkgewogICAgdGhpcy5nZXRTdmNVaVVybChwcm9jZXNzLmVudi5WVUVfQVBQX1NTT19VUkwsIHdpbmRvdy5wcm90b2NvbERvbWFpblRvVmFsaWRhdGUsIHdpbmRvdy5kb21haW5OYW1lRG9tYWluVG9WYWxpZGF0ZSwgd2luZG93LmxvY2F0aW9uLnByb3RvY29sLnNsaWNlKDAsIC0xKSwgd2luZG93LmxvY2F0aW9uLmhvc3QsIHdpbmRvdy5xdWVyeVBhcmFtcywgd2luZG93LnB1YktleSwgd2luZG93LnNob3BOYW1lLCAnMicpOwogIH0sCiAgbWV0aG9kczogewogICAgY29ubmVjdFN2Y1VpOiBmdW5jdGlvbiBjb25uZWN0U3ZjVWkoKSB7CiAgICAgIHdpbmRvdy5sb2NhdGlvbi5yZXBsYWNlKHRoaXMuc3ZjX3VpX3VybCk7CiAgICB9LAogICAgZ2V0U3ZjVWlVcmw6IGZ1bmN0aW9uIGdldFN2Y1VpVXJsKHNzb191cmwsIHByb3RvY29sRG9tYWluVG9WYWxpZGF0ZSwgZG9tYWluTmFtZURvbWFpblRvVmFsaWRhdGUsIHByb3RvY29sQm8sIGRvbWFpbk5hbWVCbywgcXVlcnlQYXJhbXMsIHB1YktleSwgc2hvcE5hbWUsIG5leHRTdGVwKSB7CiAgICAgIHRoaXMuc3ZjX3VpX3VybCA9IHNzb191cmwgKyAnL2xpbmstc2hvcC8nICsgcHJvdG9jb2xEb21haW5Ub1ZhbGlkYXRlICsgJy8nICsgZG9tYWluTmFtZURvbWFpblRvVmFsaWRhdGUgKyAnLycgKyBwcm90b2NvbEJvICsgJy8nICsgZG9tYWluTmFtZUJvICsgJy9QU1hFbW9qaS5EZWx1eGUuRmFrZS5TZXJ2aWNlJzsKICAgICAgdmFyIGJvUGF0aCA9ICcnOwoKICAgICAgZm9yICh2YXIgX2kgPSAwLCBfT2JqZWN0JGVudHJpZXMgPSBPYmplY3QuZW50cmllcyhxdWVyeVBhcmFtcyk7IF9pIDwgX09iamVjdCRlbnRyaWVzLmxlbmd0aDsgX2krKykgewogICAgICAgIHZhciBfT2JqZWN0JGVudHJpZXMkX2kgPSBfc2xpY2VkVG9BcnJheShfT2JqZWN0JGVudHJpZXNbX2ldLCAyKSwKICAgICAgICAgICAga2V5ID0gX09iamVjdCRlbnRyaWVzJF9pWzBdLAogICAgICAgICAgICB2YWx1ZSA9IF9PYmplY3QkZW50cmllcyRfaVsxXTsKCiAgICAgICAgYm9QYXRoICs9IGtleSArICc9JyArIHZhbHVlICsgJyYnOwogICAgICB9CgogICAgICBjb25zb2xlLmxvZygnZGRkZGRkZGRkJyk7CiAgICAgIHRoaXMucXVlcnlQYXJhbXMuYm8gPSAnc3RyaW5nJyA9PT0gdHlwZW9mIGJvUGF0aCA/IGVuY29kZVVSSUNvbXBvbmVudChib1BhdGguc2xpY2UoMCwgLTEpKSA6IG51bGw7CiAgICAgIHRoaXMucXVlcnlQYXJhbXMucHViS2V5ID0gJ3N0cmluZycgPT09IHR5cGVvZiBwdWJLZXkgPyBlbmNvZGVVUklDb21wb25lbnQocHViS2V5KSA6IG51bGw7CiAgICAgIHRoaXMucXVlcnlQYXJhbXMubmFtZSA9ICdzdHJpbmcnID09PSB0eXBlb2Ygd2luZG93LnNob3BOYW1lID8gZW5jb2RlVVJJQ29tcG9uZW50KHdpbmRvdy5zaG9wTmFtZSkgOiBudWxsOwogICAgICB0aGlzLnF1ZXJ5UGFyYW1zLm5leHQgPSAnc3RyaW5nJyA9PT0gdHlwZW9mIG5leHRTdGVwID8gZW5jb2RlVVJJQ29tcG9uZW50KG5leHRTdGVwKSA6IG51bGw7CiAgICAgIHRoaXMucXVlcnlQYXJhbXNMb2FkZWQoKTsKICAgICAgcmV0dXJuIHRoaXMuc3ZjX3VpX3VybDsKICAgIH0sCiAgICBxdWVyeVBhcmFtc0xvYWRlZDogZnVuY3Rpb24gcXVlcnlQYXJhbXNMb2FkZWQoKSB7CiAgICAgIHZhciBjb3VudEluaXRRdWVyeVBhcmFtcyA9IE9iamVjdC5rZXlzKHRoaXMucXVlcnlQYXJhbXMpLmxlbmd0aDsKICAgICAgdmFyIGNvdW50ZXJWYWxpZGVQYXJhbXMgPSAwOwogICAgICB0aGlzLnN2Y191aV91cmwgKz0gJz8nOwoKICAgICAgZm9yICh2YXIgX2kyID0gMCwgX09iamVjdCRlbnRyaWVzMiA9IE9iamVjdC5lbnRyaWVzKHRoaXMucXVlcnlQYXJhbXMpOyBfaTIgPCBfT2JqZWN0JGVudHJpZXMyLmxlbmd0aDsgX2kyKyspIHsKICAgICAgICB2YXIgX09iamVjdCRlbnRyaWVzMiRfaSA9IF9zbGljZWRUb0FycmF5KF9PYmplY3QkZW50cmllczJbX2kyXSwgMiksCiAgICAgICAgICAgIGtleSA9IF9PYmplY3QkZW50cmllczIkX2lbMF0sCiAgICAgICAgICAgIHZhbHVlID0gX09iamVjdCRlbnRyaWVzMiRfaVsxXTsKCiAgICAgICAgaWYgKG51bGwgIT09IHZhbHVlKSB7CiAgICAgICAgICBjb3VudGVyVmFsaWRlUGFyYW1zKys7CiAgICAgICAgICB0aGlzLnN2Y191aV91cmwgKz0gIiIuY29uY2F0KGtleSwgIj0iKS5jb25jYXQodmFsdWUsICImIik7CiAgICAgICAgfQogICAgICB9CgogICAgICBpZiAoY291bnRJbml0UXVlcnlQYXJhbXMgPT09IGNvdW50ZXJWYWxpZGVQYXJhbXMpIHsKICAgICAgICB0aGlzLnBhcmFtc19sb2FkZWQgPSB0cnVlOwogICAgICAgIHRoaXMuc3ZjX3VpX3VybCA9IHRoaXMuc3ZjX3VpX3VybC5zbGljZSgwLCAtMSk7CiAgICAgIH0KICAgIH0KICB9Cn07"},{"version":3,"sources":["PsAccount.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div v-if=\"params_loaded\" class=\"ps_account text-center\">\n      <button @click.stop.prevent=\"connectSvcUi()\" class=\"btn btn-primary\">\n        {{ buttonText }}\n      </button>\n    </div>\n    <div v-else class=\"forbidden text-center\">\n      Restart onboarding\n    </div>\n  </div>\n</template>\n<script>\n/* eslint-disable no-console */\nexport default {\n  name: 'PsAccount',\n  props: {\n    buttonText: String,\n    vue_app_svc_ui_url: String,\n  },\n  data() {\n    return {\n      svc_ui_url: null,\n      params_loaded: false,\n      queryParams: {\n        pubKey: null,\n        name: null,\n        bo: null,\n        next: null,\n      },\n    }\n  },\n  mounted() {\n    this.getSvcUiUrl(\n      process.env.VUE_APP_SSO_URL,\n      window.protocolDomainToValidate,\n      window.domainNameDomainToValidate,\n      window.location.protocol.slice(0, -1),\n      window.location.host,\n      window.queryParams,\n      window.pubKey,\n      window.shopName,\n      '2'\n    )\n  },\n\n  methods: {\n    connectSvcUi() {\n      window.location.replace(this.svc_ui_url)\n    },\n    getSvcUiUrl(\n      sso_url,\n      protocolDomainToValidate,\n      domainNameDomainToValidate,\n      protocolBo,\n      domainNameBo,\n      queryParams,\n      pubKey,\n      shopName,\n      nextStep\n    ) {\n      this.svc_ui_url =\n        sso_url +\n        '/link-shop/' +\n        protocolDomainToValidate +\n        '/' +\n        domainNameDomainToValidate +\n        '/' +\n        protocolBo +\n        '/' +\n        domainNameBo +\n        '/PSXEmoji.Deluxe.Fake.Service'\n\n      let boPath = ''\n      for (let [key, value] of Object.entries(queryParams)) {\n        boPath += key + '=' + value + '&'\n      }\nconsole.log('ddddddddd')\n      this.queryParams.bo =\n        'string' === typeof boPath\n          ? encodeURIComponent(boPath.slice(0, -1))\n          : null\n      this.queryParams.pubKey =\n        'string' === typeof pubKey ? encodeURIComponent(pubKey) : null\n      this.queryParams.name =\n        'string' === typeof window.shopName\n          ? encodeURIComponent(window.shopName)\n          : null\n      this.queryParams.next =\n        'string' === typeof nextStep ? encodeURIComponent(nextStep) : null\n      this.queryParamsLoaded()\n\n      return this.svc_ui_url\n    },\n\n    queryParamsLoaded() {\n      const countInitQueryParams = Object.keys(this.queryParams).length\n      let counterValideParams = 0\n      this.svc_ui_url += '?'\n      for (let [key, value] of Object.entries(this.queryParams)) {\n        if (null !== value) {\n          counterValideParams++\n          this.svc_ui_url += `${key}=${value}&`\n        }\n      }\n\n      if (countInitQueryParams === counterValideParams) {\n        this.params_loaded = true\n        this.svc_ui_url = this.svc_ui_url.slice(0, -1)\n      }\n    },\n  },\n}\n</script>\n<!-- Add \"scoped\" attribute to limit CSS to this component only -->\n<style scoped>\nh3 {\n  margin: 40px 0 0;\n}\nul {\n  list-style-type: none;\n  padding: 0;\n}\nli {\n  display: inline-block;\n  margin: 0 10px;\n}\na {\n  color: #42b983;\n}\n</style>\n"],"sourceRoot":"src/components"}]}